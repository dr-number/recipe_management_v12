{% load functions_html %}
<!DOCTYPE html>
<html>
<head>
    <title>Регистрация аккаунта</title>
    {% include "includes/bootstrap.css.html" %}
</head>
<body>
    <div class="container mt-5">
        <div class="row justify-content-center">
            <div class="col-md-6">
                <div class="card">
                    <div class="card-header">
                        <h4 class="mb-0">Регистрация аккаунта</h4>
                    </div>
                    <div class="card-body">
                        <a href="{{'HOST'|get_const}}/main/front/loginin/">Домой</a>
                        <a href="{{'HOST'|get_const}}/main/front/support/">Техподдержка</a>
                        {% if api_errors %}
                            <div class="alert alert-danger">
                                {% for field, errors in api_errors.items %}
                                    {% if field != 'code' %}
                                        {{ errors|join:", " }}
                                    {% endif %}
                                {% endfor %}
                            </div>
                        {% endif %}
                        
                        <form method="post">
                            {% for field in form %}
                                <div class="mb-3">
                                    <label for="{{ field.id_for_label }}" class="form-label">
                                        {{ field.label }}
                                    </label>
                                    {{ field }}
                                    {% if field.errors %}
                                        <div class="text-danger small">
                                            {{ field.errors|join:", " }}
                                        </div>
                                    {% endif %}
                                </div>
                            {% endfor %}
                            
                            <button type="submit" class="btn btn-primary w-100">Зарегистрироваться</button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!--modal code--->
    <!-- Модальное окно подтверждения email -->
<div id="confirmationModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1000;">
    <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; padding: 20px; border-radius: 8px; min-width: 400px;">
        <div style="display: flex; justify-content: between; align-items: center; margin-bottom: 15px;">
            <h3 style="margin: 0;">Подтверждение email</h3>
            <button type="button" onclick="hideConfirmationModal()" style="background: none; border: none; font-size: 20px; cursor: pointer;">×</button>
        </div>
        
        <p>На вашу почту отправлен код подтверждения. Введите его ниже:</p>
        
        <form id="confirmationForm">
            <input type="hidden" id="confirmation_user_id" name="user_id">
            
            <div style="margin-bottom: 15px;">
                <label for="confirmation_code" style="display: block; margin-bottom: 5px;">Код подтверждения</label>
                <input 
                    type="text" 
                    style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px;" 
                    id="confirmation_code" 
                    name="code"
                    placeholder="Введите код"
                    required
                >
            </div>
            
            <div style="display: flex; flex-direction: column; gap: 10px;">
                <button type="submit" style="padding: 10px; background: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer;" id="confirmBtn">
                    Подтвердить
                </button>
                <button type="button" style="padding: 10px; background: #f8f9fa; color: #333; border: 1px solid #ddd; border-radius: 4px; cursor: pointer;" id="resendCodeBtn">
                    Отправить код повторно
                </button>
            </div>
        </form>
        
        <div id="confirmationMessages" style="margin-top: 15px;"></div>
    </div>
</div>
    <!--end modal code--->

    {% include "includes/server_js.html" %}
</body>
</html>